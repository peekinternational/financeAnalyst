function clearStepProgress(e){$(e).find("i.desktop").removeClass("mdi-pencil-circle mdi-check-circle text-green").addClass("mdi-checkbox-blank-circle-outline text-muted"),$(e).find("i.mobile").removeClass("text-green").addClass("text-muted"),$(e).find("div").removeClass("text-green").addClass("text-muted")}function startStepProgress(e){$(e).find("i.desktop").removeClass("mdi-checkbox-blank-circle-outline mdi-check-circle text-green text-muted").addClass("mdi-pencil-circle"),$(e).find("i.mobile").removeClass("text-green text-muted"),$(e).find("div").removeClass("text-green text-muted")}function finishStepProgress(e){$(e).find("i.desktop").removeClass("mdi-pencil-circle mdi-checkbox-blank-circle-outline text-muted").addClass("mdi-check-circle text-green"),$(e).find("i.mobile").removeClass("text-muted").addClass("text-green"),$(e).find("div").removeClass("text-muted").addClass("text-green")}function setStepProgress1(){startStepProgress($stepProgress1),clearStepProgress($stepProgress2),clearStepProgress($stepProgress3)}function setStepProgress2(){finishStepProgress($stepProgress1),startStepProgress($stepProgress2),clearStepProgress($stepProgress3)}function setStepProgress3(){finishStepProgress($stepProgress1),finishStepProgress($stepProgress2),startStepProgress($stepProgress3)}function showStep1(){setStepProgress1(),$headline.html($step1.data("headline")),$step1.show(),$step2.hide(),$step3.hide()}function showStep2(){setStepProgress2(),$headline.html($step2.data("headline")),$step1.hide(),$step3.hide(),$step2.fadeIn("slow",function(){$step2.find("#input-subject").focus()})}function showStep3(){setStepProgress3(),$headline.html($step3.data("headline")),$step2.hide(),$step3.fadeIn("slow",function(){$step3.find("#input-name").focus()})}function step1validation(){var e=0;$("input.rating-value").each(function(){e+=parseInt($(this).val())}),e?showStep2():step1error()}function step2validation(){clearValidationErrors();var e=null,t=$("#input-subject"),s=$("#input-content");return t.val().length||(e=throwValidationError(t)),s.val().length||(e=throwValidationError(s)),e}function step3ratingValidation(){clearValidationErrors();var e=null,t=$review.find("#input-name"),s=$review.find("#input-email"),r=$review.find("#input-phone"),n=$review.find("#input-conditions");return t.val().length<=2&&(e=throwValidationError(t)),s.val().length&&isEmail(s.val())||(e=throwValidationError(s)),r.val().length<=7&&(e=throwValidationError(r)),n.length&&(n.is(":checked")||(e=throwValidationError(n))),e}function step3ratingPost(){analytics.track("write_partner_review",{partner_id:$("#hidden-partner-id").val(),session_id:$("#hidden-session-id").val(),review:{title:$("#input-subject").val(),comment:$("#input-content").val(),email:$("#input-email").val(),name:$("#input-name").val(),phone:$("#input-phone").val(),rating_total:parseInt($("#hidden-rating-total").val()),rating_parameters:{quality:parseInt($("#hidden-rating-quality").val()),contact:parseInt($("#hidden-rating-contact").val()),expertise:parseInt($("#hidden-rating-expertise").val()),schedule:parseInt($("#hidden-rating-schedule").val()),budget:parseInt($("#hidden-rating-budget").val())}}}),$review.submit()}function step1error(){$step1.find(".form-group").removeClass("has-error"),$("input.rating-value").each(function(){0==$(this).val()&&$step1.find($(this).data("error-target")).closest(".form-group").addClass("has-error")})}function step1proceed(){var e=!0;$("input.rating-value").each(function(){0==$(this).val()&&(e=!1)}),e===!0&&$step1button.addClass("btn-green").removeClass("btn-default")}function step2proceed(e){e.val().length>120?$step2button.addClass("btn-green").removeClass("btn-default"):$step2button.addClass("btn-default").removeClass("btn-green")}function createRating(e){if($(e).length>0){for(var t=$(e).data("size"),s="",r=1;r<=5;r++)s+='<i class="mdi mdi-star star star-'+t+' star-theme-0" data-value="'+r+'"></i>';$(e).html(s)}return!1}function validateMessage(){clearValidationErrors();var e=null,t=$("#input-message-description"),s=$("#input-message-name"),r=$("#input-message-email"),n=$("#input-message-phone");return t.val().length||(e=throwValidationError(t)),s.val().length||(e=throwValidationError(s)),r.val().length&&isEmail(r.val())||(e=throwValidationError(r)),n.val().length||(e=throwValidationError(n)),e}function sendMessage(){null===validateMessage()&&(analytics.track("send_message_to_partner",{partner_id:$msgForm.find('[name="partner_id"]').val(),session_id:$msgForm.find('[name="session_id"]').val(),message:{full_name:$msgForm.find('[name="full_name"]').val(),email:$msgForm.find('[name="email"]').val(),phone_number:$msgForm.find('[name="phone_number"]').val(),content:$msgForm.find('[name="description"]').val()}}),$msgForm.submit())}var $review=$("form.review"),$step1=$(".step-1"),$step2=$(".step-2"),$step3=$(".step-3"),$step1button=$(".step-1-proceed-button"),$step2button=$(".step-2-proceed-button"),$step3button=$(".step-3-proceed-button"),$headline=$("#review .modal-header h4"),$stepProgress1=$(".step-progress .step-progress-1"),$stepProgress2=$(".step-progress .step-progress-2"),$stepProgress3=$(".step-progress .step-progress-3");$step1.on("click",".step-1-proceed-button",function(e){e.preventDefault(),step1validation()}),$step1.on("click",".rating-picker",function(){step1proceed()}),$step2.on("click",".step-2-proceed-button",function(e){e.preventDefault(),null===step2validation()&&showStep3()}),$step2.find("#input-content").on("input",function(){step2proceed($(this))}),$step3.on("click",".step-3-submit-button",function(e){e.preventDefault(),null===step3ratingValidation()&&step3ratingPost()}),$review.on("click",".back-step-1",function(e){e.preventDefault(),$step1.find(".form-group").removeClass("has-error"),showStep1()}),$review.on("click",".back-step-2",function(e){e.preventDefault(),showStep2()}),$(function(){showStep1()});var rp=$(".rating-picker");rp.on("mouseover",".star",function(){$(this).prevAll(".star").addBack(".star").addClass("star-hover-"+$(this).data("value"))}),rp.on("mouseout",".star",function(){$(this).prevAll(".star").addBack(".star").removeClass("star-hover-1 star-hover-2 star-hover-3 star-hover-4 star-hover-5")}),rp.on("click",".star",function(){$(this).parent().children(".star").removeClass("star-theme-1 star-theme-2 star-theme-3 star-theme-4 star-theme-5"),$(this).prevAll(".star").addBack(".star").addClass("star-theme-"+$(this).data("value")),$($(this).parent(".rating-picker").data("target")).val($(this).data("value")),$(this).closest(".form-group").removeClass("has-error");var e=0,t=0;$("input.rating-value").each(function(){e+=parseInt($(this).val()),parseInt($(this).val())>0&&t++}),$("#hidden-rating-total").val(Math.round(e/t))}),$(document).ready(function(){$(".rating-picker").each(function(){createRating($(this))})});var $msgForm=$("form.send-message"),btnSendMessage=$(".btn-send-message");btnSendMessage.click(sendMessage);