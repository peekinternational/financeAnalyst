function noResults(e){e.append("<li>"+$noResults.html()+"</li>")}function parsePartners(e){var r=[];return $.each(e,function(e,t){r.push('<li><a href="'+t.slug+'" target="_blank">'+t.company_name+"</a></li>")}),r}function parseLocations(e){var r=[];return $.each(e,function(e,t){r.push('<li><a href="'+t.slug_full+'" target="_blank">'+t.city_name+"</a></li>")}),r}function clearSearch(){$resultsPartners.find("ul").html(""),$resultsLocations.find("ul").html("")}function performSearch(e){clearSearch(),$.getJSON("/directory-search?search_term="+e,function(e){$spinner.hide(),e.partners.length>0?$.each(parsePartners(e.partners),function(e,r){$resultsPartners.find("ul").append(r)}):noResults($resultsPartners.find("ul")),$resultsPartners.fadeIn("slow"),e.locations.length>0?$.each(parseLocations(e.locations),function(e,r){$resultsLocations.find("ul").append(r)}):noResults($resultsLocations.find("ul")),$resultsLocations.fadeIn("slow")})}function loadMoreLocalPartners(e){return partnerDirectoryPage>=partnerDirectoryPageCount?void $("#load-more-button").closest("ul").remove():void $.getJSON("/directory-partners?city="+e+"&page="+partnerDirectoryPage+"&industry="+industryCode,function(e){$.each(e,function(e,r){renderPartnerTableRow(r)}),partnerDirectoryPage++})}function renderPartnerTableRow(e){var r=["<tr>",'<td class="text-center text-bold">','<a href="'+e.slug+'">','<div class="img-thumbnail partner-company-logo" style="background-image: url(\''+e.logo+"');\"></div>\n","</a>","</td>","<td>",'<div class="partner-content-holder"><a href="'+e.slug+'"><strong>'+e.company_name+"</strong></a></div>",'<div class="partner-content-holder">',e.description?e.description.substr(0,250)+(e.description.length>=250?"...":""):renderPartnerAddress(e),"</div>","</td>\n",'<td class="text-center"><a href="'+e.location.slug+'" '+e.location.rel+" >"+e.location.city_name+"</a></td>\n",'<td class="text-center">'+e.industry+"</td>","</tr>"];$("#local-partners tbody").append(r.join(""))}function renderPartnerAddress(e){return e.location.address&&"-"!=e.location.address?e.location.address+"<br>"+e.location.zip_code+" "+e.location.city_name:""}var $searchField=$(".search-field"),$searchBox=$(".search-results-box"),$spinner=$(".search-results-box .spinner"),$resultsPartners=$(".search-results-partners"),$resultsLocations=$(".search-results-locations"),$noResults=$(".search-results-box .no-results"),callDelay,partnerDirectoryPage=2,partnerDirectoryPageCount=$("#partnerDirectoryPageCount").val(),industryCode=$("#partnerDirectoryIndustry").val();$searchField.on("input","input:text",function(){clearTimeout(callDelay),callDelay=setTimeout(function(){$searchField.find("input:text").val().length>0&&($searchBox.fadeIn("slow"),performSearch($searchField.find("input:text").val())),0==$searchField.find("input:text").val().length&&$searchBox.fadeOut("slow")},500)}),$(".close-search-box").click(function(){$searchBox.fadeOut("slow",function(){clearSearch()})}),$(function(){$(".nearby-cities").on("change",function(){var e=$(this).val();return e&&(window.location=e),!1})});